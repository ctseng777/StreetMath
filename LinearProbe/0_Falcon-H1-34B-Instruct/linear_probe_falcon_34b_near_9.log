`torch_dtype` is deprecated! Use `dtype` instead!
The following generation flags are not valid and may be ignored: ['output_hidden_states']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
The fast path is not available because one of `(selective_state_update, causal_conv1d_fn, causal_conv1d_update)` is None. Falling back to the naive implementation. To install follow https://github.com/state-spaces/mamba/#installation and https://github.com/Dao-AILab/causal-conv1d
============================================================
Linear Probing on Falcon-H1-34B — Target: Near-9
============================================================

========== FALCON_34B: tiiuae/Falcon-H1-34B-Instruct ==========
Loading checkpoint shards:   0%|          | 0/14 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 1/14 [00:07<01:42,  7.86s/it]Loading checkpoint shards:  14%|█▍        | 2/14 [00:15<01:35,  7.93s/it]Loading checkpoint shards:  21%|██▏       | 3/14 [00:24<01:29,  8.11s/it]Loading checkpoint shards:  29%|██▊       | 4/14 [00:32<01:20,  8.03s/it]Loading checkpoint shards:  36%|███▌      | 5/14 [00:40<01:12,  8.10s/it]Loading checkpoint shards:  43%|████▎     | 6/14 [00:48<01:04,  8.09s/it]Loading checkpoint shards:  50%|█████     | 7/14 [00:56<00:56,  8.07s/it]Loading checkpoint shards:  57%|█████▋    | 8/14 [01:04<00:49,  8.20s/it]Loading checkpoint shards:  64%|██████▍   | 9/14 [01:12<00:40,  8.07s/it]Loading checkpoint shards:  71%|███████▏  | 10/14 [01:20<00:32,  8.12s/it]Loading checkpoint shards:  79%|███████▊  | 11/14 [01:28<00:24,  8.10s/it]Loading checkpoint shards:  86%|████████▌ | 12/14 [01:36<00:16,  8.05s/it]Loading checkpoint shards:  93%|█████████▎| 13/14 [01:45<00:08,  8.13s/it]Loading checkpoint shards: 100%|██████████| 14/14 [01:50<00:00,  7.24s/it]Loading checkpoint shards: 100%|██████████| 14/14 [01:50<00:00,  7.88s/it]
Layers: 73 | Width: 5120
  [Progress] Starting stream for 4000 samples (4000 batches)...
    Processing batch 100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1000/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2000/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3000/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 4000/4000... (Total NaN found: 0, Rate: 0.0000%)
  [Progress] Starting stream for 4000 samples (4000 batches)...
    Processing batch 100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1000/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2000/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 2900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3000/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3100/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3200/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3300/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3400/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3500/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3600/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3700/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3800/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 3900/4000... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 4000/4000... (Total NaN found: 0, Rate: 0.0000%)
Evaluating digits_paraphrase...
  [Progress] Starting stream for 1500 samples (1500 batches)...
    Processing batch 100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 500/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 600/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 700/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 800/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 900/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1000/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1500/1500... (Total NaN found: 0, Rate: 0.0000%)
  Best layer 15: acc=0.815
  [Progress] Starting stream for 1500 samples (1500 batches)...
    Processing batch 100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 500/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 600/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 700/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 800/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 900/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1000/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1500/1500... (Total NaN found: 0, Rate: 0.0000%)
Evaluating words...
  [Progress] Starting stream for 1500 samples (1500 batches)...
    Processing batch 100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 500/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 600/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 700/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 800/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 900/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1000/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1500/1500... (Total NaN found: 0, Rate: 0.0000%)
  Best layer 17: acc=0.677
  [Progress] Starting stream for 1500 samples (1500 batches)...
    Processing batch 100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 500/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 600/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 700/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 800/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 900/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1000/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1100/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1200/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1300/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1400/1500... (Total NaN found: 0, Rate: 0.0000%)
    Processing batch 1500/1500... (Total NaN found: 0, Rate: 0.0000%)
Done. Results saved to probe_results_falcon_h1_34b_instruct_near_9.json
